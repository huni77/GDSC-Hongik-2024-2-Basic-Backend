# 스프링 빈
어플리케이션 전역에서 사용할 공용 객체
스프링 컨테이너라고 하는 공용 창고에 빈(객체)을 저장해두고,
필요한 빈을 컨테이너에서 받아 사용한다.

필요한 빈은 스프링 프레임워크가 자동으로 가져다 준다.
이때 빈을 요구하는 객체도 스프링 빈이다.
(빈이 아닌 객체가 빈을 요구해도 프레임워크가 자동으로 가져다주지는 못한다.)

# 스프링 컨테이너

스프링 빈이 저장되는 공간
어플리케이션 컨텍스트(Application Context) 라고도 한다.

# 스프링 컨테이너에 스프링 빈을 저장하는 방법

## 1. 설정 파일 작성
설정 파일은 자바 클래스로 작성한다.
이때 클래스에 @Configuration 으로 설정 파일임을 명시한다.

스프링 빈은 기본적으로 1개의 객체이다.
따라서 컨테이너에서 빈을 가져올 때마다 같은 객체가 반환된다

## 2. 컴포넌트 스캔
빈을 생성할 클래스에 @Component 어노테이션 사용
어플리케이션을 시작할 때 @Component가 붙은 클래스를 찾아서 자동으로 빈 등록

## 스프링 빈 등록 요약

내가 등록할 빈을 생성하는 클래스에 @Component를 붙이면 된다.

# 스프링 컨테이너에서 스프링 빈을 받아오는 방법

# 의존성이란?
자동차가 움직이려면 바퀴가 필요하듯이
A의 기능을 실행하는데 B의 기능이 필요하다면 'A는 B에 의존한다' 라고 한다.

## 의존성 주입이란?
내가 의존하는 객체를 직접 생성하지 않고 밖에서 주입받는것.

스프링에서는 컨테이너에 저장된 빈(객체)과 빈(객체)사이의 의존성을
프레임워크가 주입하는 것을 말한다.

Cf) 빈이 아닌 객체에 빈을 자동으로 주입할 수는 없다. 스프링이 빈을 주입하려면,
두 객체 모두 스프링에 의해 관리 (=빈으로 등록) 되어야 하기 때문이다

## 의존성 주입을 받는 이유
1. 객체 지향 원칙 중 하나인 OCP(Open Close Principle) 원칙을 준수하기 위함.
(필요한 객체를 내가 하드코딩하지 않기 때문에 유지보수하기 좋아진다)
2. 매번 필요한 객체를 생성하는 대신, 생성해둔 객체를 사용하므로
메모리를 효율적으로 사용할 수 있다

## 의존성 주입을 받는 방법
어떤 객체에 다른 객체를 주입하려면, 주입할 통로가 필요하다.
 - 통로는 생성자, 필드, 메서드 3개가 있다. 이 중 메서드는 잘 쓰이지 않는다.

우리는 통로를 만들고, 이 통로를 통해 주입해 달라고 표시해두면
프레임워크가 알아서 객체를 주입해준다.
- 표시를 남길 때는 @Autowired 어노테이션으로 남긴다.

### 생성자 주입 방법
주로 동작하는 어플리케이션 코드를 작성할 때 사용한다.

1. 필요한 의존성을 final 키워드를 사용해 추가한다.
의존성이 바뀔 일이 없는 경우 안전하게 final로 선언한다.
이때 final 필드는 생성자를 통해 초기화되어야 한다

생성자에 @Autowired 을 사용하면, 생성자를 통해 빈을 주입한다.
만약 생성자가 하나만 있다면, @Autowired를 생략할 수 있다.

2. @RequiredArgsConstructor를 사용해 생성자를 추가한다.
롬복(lombok)의 @RequiredArgsConstructor를 사용하면
모든 final 필드에 대한 생성자를 자동으로 만들어주어
생성자 코드까지 생략할 수 있다

### 생성자 주입 테스트방법

MyBean과 MySubBean 객체가 컨테이너 내부에 있다고 할 때
스프링 빈을 의존성으로 주입했다면,
MyBean 객체가 갖고 있는 MySubBean 객체와
스프링 컨테이너에 들어있는 MySubBean 객체는 동일할 것이다.

### 필드 주입 방법
주로 테스트 코드를 작성할 때 사용한다.

필드에 바로 @Autowired 어노테이션을 사용한다.(final 사용불가)

테스트에서 필드 주입을 하려면, 테스트를 실행할 때
이미 스프링 컨테이너가 존재해야 한다.

클래스에 @SpringBootTest 어노테이션을 사용하면
어플리케이션에 있는 모든 빈을 컨테이너에 등록한 후 테스트한다.
스프링 부트까지 실행시키므로, 통합 테스트에도 사용할 수 있다

# 스프링 Layered Architecture

1. 컨트롤러
클라이언트의 요청을 받고, 응답을 보내는 계층
DTO (Data Transfer Object)를 사용하여
서비스 계층과 데이터를 주고받는다

2. 서비스
어플리케이션의 비즈니스 로직이 담기는 계층
레포지토리 계층과 소통하며 엔티티, 또는 DTO로 소통한다

3. 레포지토리
DB와 소통하며 데이터를 조작하는 계층
서비스 계층이 결정한 비즈니스 로직을 실제 DB에 적용한다

# 스프링 빈과 컨테이너 활용

컨트롤러와 서비스 레포지토리는 스프링 빈으로 등록한다.
매번 새로운 객체를 생성할 필요가 없고,객체지향 원칙을 준수하며 의존성을 관리할 수 있기 때문이다

# 최종 정리
스프링 빈 = 공동으로 사용할 하나의 객체
스프링 컨테이너 = 빈을 저장하는 공용 공간
의존성 주입 = 프레임워크가 필요한 빈을 주입하는 것

컨테이너에 빈을 저장하는 방법 : 설정 파일 or 컴포넌트 스캔
컨테이너에서 빈을 주입받는 방법 : 생성자 주입 or 필드 주입




